(function(){let w=window.location.search.includes("debug=true");function X(...q){if(w)console.log("[Scheduler Display]",...q)}let j="sole_prop",O="round_robin",Q={sole_prop:{url:"https://meetings.hubspot.com/bz/consultation",name:"Sole Proprietor Consultation",description:"For single-owner practices"},s_corp:{url:"https://meetings.hubspot.com/bz/consultations",name:"S-Corp Consultation",description:"For multi-owner practices"}};function A(q){try{let V=["is_your_practice_a_c_corp_or_our_does_it_have_multiple_owners_","does_your_practice_have_multiple_owners","multiple_owners","practice_multiple_owners","has_multiple_owners"],W=null;for(let $ of V)if(q&&q[$]){W=q[$];break}if(!W)return"sole_prop";let J=String(W).toLowerCase().trim();if(J==="yes"||J==="true")return"s_corp";if(J==="no"||J==="false")return"sole_prop";return"sole_prop"}catch(V){return"sole_prop"}}function z(q,V){let W=window.HubSpotRouter&&window.HubSpotRouter.config&&window.HubSpotRouter.config[q]||Q[q]||Q.sole_prop,J=new URL(W.url);return J.searchParams.set("embed","true"),Object.entries({email:["email","email_address"],firstName:["firstname","first_name","fname"],lastName:["lastname","last_name","lname"],company:["company","practice_name","business_name"],phone:["phone","phone_number","telephone"]}).forEach(([Z,M])=>{for(let H of M)if(V&&V[H]){J.searchParams.set(Z,V[H]);break}}),["utm_source","utm_medium","utm_campaign","utm_content","utm_term"].forEach((Z)=>{if(V&&V[Z])J.searchParams.set(Z,V[Z])}),J.toString()}function B(){try{let q=sessionStorage.getItem("scheduler_router_data");if(q){let V=JSON.parse(q);return sessionStorage.removeItem("scheduler_router_data"),V}}catch(q){X("SessionStorage error:",q)}try{let q=(J)=>{let x=`; ${document.cookie}`.split(`; ${J}=`);if(x.length===2)return x.pop().split(";").shift()},V=q("scheduler_type"),W=q("form_data");if(V||W){let J=W?JSON.parse(atob(W)):{};return document.cookie="scheduler_type=; path=/; max-age=0",document.cookie="form_data=; path=/; max-age=0",{scheduler_type:V,formData:J}}}catch(q){X("Cookie error:",q)}return null}function Y(){let q={},V=new URLSearchParams(window.location.search);for(let[W,J]of V)q[W]=J;return q}function b(q){try{if(typeof fbq!=="undefined")fbq("track","Lead",{content_category:"consultation",content_name:q+"_consultation"});if(typeof rdt!=="undefined")rdt("track","Lead",{customEventName:"ConsultationScheduler",schedulerType:q});if(typeof gtag!=="undefined")gtag("event","generate_lead",{event_category:"engagement",event_label:q+"_consultation"});else if(typeof ga!=="undefined")ga("send","event","Lead","Generate",q+"_consultation");if(typeof window.posthog!=="undefined")window.posthog.capture("scheduler_lead_generated",{scheduler_type:q});if(typeof window.amplitude!=="undefined")window.amplitude.track("scheduler_lead_generated",{scheduler_type:q});X("Lead events fired for:",q)}catch(V){X("Lead tracking error:",V)}}function v(){let q=document.getElementById("scheduler-target");if(!q){console.error('[Scheduler Display] No element with id="scheduler-target" found');return}let V=Y(),W=B(),J={...V};if(W&&W.formData)J={...J,...W.formData};X("Params:",J),X("Forcing round-robin scheduler (ignoring scheduler_type)");let $=window.HubSpotRouter&&window.HubSpotRouter.config?window.HubSpotRouter.config:Q,x=$[j]||$.sole_prop,Z=window.HubSpotRouter&&typeof window.HubSpotRouter.buildSchedulerUrl==="function"?window.HubSpotRouter.buildSchedulerUrl(j,J):z(j,J);X("Loading scheduler:",x&&x.name?x.name:"Round Robin"),X("URL:",Z),q.innerHTML=`<div class="meetings-iframe-container" data-src="${Z}"></div>`;let M=document.createElement("script");M.src="https://static.hsappstatic.net/MeetingsEmbed/ex/MeetingsEmbedCode.js",M.onload=function(){X("Scheduler loaded"),b(O)},M.onerror=function(){console.error("[Scheduler Display] Failed to load scheduler")},document.head.appendChild(M)}function K(){v()}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",K);else K();if(w)window.SchedulerDisplay={getRouterData:B,getQueryParams:Y,determineSchedulerTypeFallback:A,buildSchedulerUrlFallback:z,fireLeadEvents:b,injectScheduler:v,init:K}})();
