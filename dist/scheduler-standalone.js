(function(){let X=window.location.search.includes("debug=true");function H(...q){if(X)console.log("[Scheduler Display]",...q)}function Y(){try{let q=sessionStorage.getItem("scheduler_router_data");if(q){let z=JSON.parse(q);return sessionStorage.removeItem("scheduler_router_data"),z}}catch(q){H("SessionStorage error:",q)}try{let q=(F)=>{let J=`; ${document.cookie}`.split(`; ${F}=`);if(J.length===2)return J.pop().split(";").shift()},z=q("scheduler_type"),A=q("form_data");if(z||A){let F=A?JSON.parse(atob(A)):{};return document.cookie="scheduler_type=; path=/; max-age=0",document.cookie="form_data=; path=/; max-age=0",{scheduler_type:z,formData:F}}}catch(q){H("Cookie error:",q)}return null}function Z(){let q={},z=new URLSearchParams(window.location.search);for(let[A,F]of z)q[A]=F;return q}function _(q){try{if(typeof fbq!=="undefined")fbq("track","Lead",{content_category:"consultation",content_name:q+"_consultation"});if(typeof rdt!=="undefined")rdt("track","Lead",{customEventName:"ConsultationScheduler",schedulerType:q});if(typeof gtag!=="undefined")gtag("event","generate_lead",{event_category:"engagement",event_label:q+"_consultation"});else if(typeof ga!=="undefined")ga("send","event","Lead","Generate",q+"_consultation");if(typeof window.posthog!=="undefined")window.posthog.capture("scheduler_lead_generated",{scheduler_type:q});if(typeof window.amplitude!=="undefined")window.amplitude.track("scheduler_lead_generated",{scheduler_type:q});H("Lead events fired for:",q)}catch(z){H("Lead tracking error:",z)}}function N(){let q=document.getElementById("scheduler-target");if(!q){console.error('[Scheduler Display] No element with id="scheduler-target" found');return}let z=Z(),A=Y(),F={...z},I=z.scheduler_type;if(A){if(A.formData)F={...F,...A.formData};if(A.scheduler_type)I=A.scheduler_type}if(H("Params:",F),H("Scheduler type:",I),!I&&window.HubSpotRouter)I=window.HubSpotRouter.determineSchedulerType(F);if(!window.HubSpotRouter||!window.HubSpotRouter.config){console.error("[Scheduler Display] HubSpot Router not loaded");return}let J=window.HubSpotRouter.config[I]||window.HubSpotRouter.config.sole_prop,$=window.HubSpotRouter.buildSchedulerUrl(I,F);H("Loading scheduler:",J.name),H("URL:",$),q.innerHTML=`<div class="meetings-iframe-container" data-src="${$}"></div>`;let K=document.createElement("script");K.src="https://static.hsappstatic.net/MeetingsEmbed/ex/MeetingsEmbedCode.js",K.onload=function(){H("Scheduler loaded"),_(I)},K.onerror=function(){console.error("[Scheduler Display] Failed to load scheduler")},document.head.appendChild(K)}function V(){if(window.HubSpotRouter)N();else{let q=0,z=setInterval(()=>{if(q++,window.HubSpotRouter)clearInterval(z),N();else if(q>20)clearInterval(z),console.error("[Scheduler Display] Router timeout")},100)}}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",V);else V();if(X)window.SchedulerDisplay={getRouterData:Y,getQueryParams:Z,fireLeadEvents:_,injectScheduler:N,init:V}})();
